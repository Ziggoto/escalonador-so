<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<title>Escalonador</title>
		<meta name="description" content="">
		<meta name="author" content="Fábio M. Theophilo">

		<meta name="viewport" content="width=device-width; initial-scale=1.0">

		<script src="static/jquery-2.1.1.min.js"></script>
		<script src="static/jcanvas.min.js"></script>
		<script>
			var ws = new WebSocket("ws://localhost:8888/websocket");
			
			ws.onopen = function() {
				console.log("Desenha pela primeira vez");

				t = new Date().getTime();
				$("#escalonador").attr("src", "static/escalonador.png?t="+t);
			};

			//TODO fazer a lógica para redesenhar...
			ws.onmessage = function (evt) {
				code = evt.data;
				console.log("Desenha");
				$("#escalonador").attr("src", "data:image/jpg;base64,"+code);
			};
		</script>
		<script>
		$(function(){
			$("#envia").click(function(){
				var algoritimo = $("#algoritmo").val();
				var cores = $("#cores").val();
				var filas = $("#fila").val();
				var quantum = $("#tempo_quantum").val();

				if(!(cores >= 1 && cores <= 64) || !(quantum >= 2 && quantum <= 20)){
					console.log("Paramêtros Incorretos");
					return false;
				}

				var msg = {
					atividade: 0,
					algoritimo: algoritimo,
					cores: cores,
					filas: filas,
					quantum: quantum
				};

				ws.send(JSON.stringify(msg));
				console.log(msg);
			});

			$("#tempo_quantum").click(function(){
				console.log("Adiciona Processo");

				var msg = {atividade: 1};
				ws.send(JSON.stringify(msg));
			});
		});
		</script>
		
	</head>

	<body>
	<p>
	<table>
		<tr>
			<td>
				Selecione o tipo de algoritimo:
				<select id="algoritmo">
					<option value="0">FIFO</option>
					<option value="1">Filas de Prioridade Híbrido</option>
					<option value="2">Round Robin</option>
					<option value="3">Shortest Job First</option>
					<option value="4">Shortest Remaining Time</option>
				</select>
			</td>
			<td>
				Nº de Core's:
				<input type="text" size="1" name="cores" id="cores" value="4" />	
			</td>
			<td>
				Tamanho da fila:
				<input type="text" size="1" name="fila" id="fila" value="4" />
			</td>
			<td>
				Tempo do Quantum:
			<input type="text" size="1" name="tempo_quantum" id="tempo_quantum" value="4" />
			</td>
			<td>
				<input type="button" id="envia" value="Enviar">
			</td>
		</tr>
		<tr>
			<td>
				<input type="button" id="add_processo" value="Adicionar Processo" />		
			</td>
		</tr>
	</table>
			
	</p>
	<hr />
	<p align="center">
		<img id="escalonador" src="">
		</canvas>
	</p>

	</body>
</html>
